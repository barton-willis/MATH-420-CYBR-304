\documentclass[portrait,fleqn,12pt]{beamer}
\usetheme[progressbar=frametitle]{metropolis}
\usepackage{amsmath}
\usepackage{fleqn,amssymb,shadow}
\usepackage{float}
\usepackage{epsfig}
\usepackage{enumerate}
\usepackage{cancel}
\usepackage{fontawesome5}
%\usepackage{fourier}
\usepackage{upgreek}
\raggedright

% Custom commands
\newcommand{\fma}{{\rm fma}}
\newcommand{\reals}{\mathbf{R}}
\newcommand{\epsmach}{\varepsilon_m}
\newcommand{\mymax}{\mbox{max} \,\,}
\newcommand{\mydeg}{\mbox{deg}}
\newcommand{\dom}{\mbox{dom}}
\newcommand{\fl}{\mbox{fl}}
\newcommand{\rel}{\mbox{rel}}
\newcommand{\cond}{\mbox{cond}}
\newcommand{\bern}{\mathcal{B}}
\newcommand{\order}{\mathcal{O}}
\newcommand{\atan}{\rm{arctan}}
\newcommand{\bfa}{\mathbf{a}}
\newcommand{\bfb}{\mathbf{b}}
\newcommand{\bfzero}{\mathbf{0}}
\newcommand{\bfx}{\mathbf{x}}
\newcommand{\complex}{\mathbf{C}}
\newcommand{\integers}{\mathbf{Z}}

% Custom environments
\newenvironment{alphalist}
   {\begin{enumerate}[(a)]
       \addtolength{\itemsep}{0.0\itemsep}}
     {\end{enumerate}}

\newenvironment{handlist}
   {\begin{enumerate}[\faHandPointRight]
       \addtolength{\itemsep}{0.0\itemsep}}
     {\end{enumerate}}

\newenvironment{define}[1]{
  \textbf{Definition} #1}{}

\newenvironment{idefine}[2]{
  \index{#1}
  \textbf{Definition} #2}{\(\blacktriangleleft\)}

\newenvironment{myexample}[1]{
  \textbf{Example} #1}


\newenvironment{mynote}[1]{
  \textbf{Note} #1}

\begin{document}

\begin{frame}
\begin{flushleft} 
\textbf{Fun with generating functions} \\
MATH 202 \\
\today 
\end{flushleft}


\emph{“The law is reason unaffected by desire.”} \hfill {\sc Aristotle } 
\end{frame}


\begin{frame}[fragile]{Our problem}
We would like to find an explicit formula for the sequence $c$ that is defined recursively by
\begin{equation}
  c_n= \begin{cases} 0 & n \in \{0,1\} \\
                                 c_{n-1} + c_{n-2}+ 8 & n \in \integers_{\geq 2}
           \end{cases}
\end{equation}
\begin{handlist}
\item The first eleven terms of the seqence $c$ are
\begin{equation}
      0,0,8,16,32,56,96,160,264,432,704
\end{equation}
\item To complete this task, we need three new tools
\end{handlist}
\end{frame}
\begin{frame}{Tool 1:  Binomial Coefficents}

For positive integers $n$ and $k$ with $n \geq k$, we define
\begin{equation}
      \binom{n}{k} = \frac{n!}{k! (n-k)!}
\end{equation}
\begin{handlist}
 \item Spoken $\binom{n}{k}$ is ``$n$ choose $k$.''
 \item For a finite set $A$ with exactly $n$ members,  $\binom{n}{k}$ is the number of subsets of $A$ that have exactly $k$ members.
\end{handlist}
\end{frame}

\begin{frame}{Tool 2:  Product rule for $n$-th derivatives}

For smooth functions $f$ and $g$ and a nonnegative integer $n$, the n-th derivative of the product of $f$ times $g$ is
\begin{equation}
       D^n (f g) = \sum_{k=0}^n  \binom{n}{k}  f^{k} g^{n-k}.
\end{equation}
\begin{handlist}
\item This is a fun generalization of the product rule for derivatives.
\end{handlist}
\end{frame}


\begin{frame}{Tool 3:  $n$-th derivative of a power series}

Let $c$ be a sequence and let $n$ be a nonnegative integer.  Then
\begin{equation}
      \left.  D^n_x \left( \sum_{k=0}^\infty c_k x^k  \right)  \right \vert_{x=0} = n!  c_n.
\end{equation}
\begin{handlist}
 \item The operator order is sum first, derivative second, and  evaluation at zero third.
   \item For this to be true, it has to be the case that  the radius of convergence of the series is nonzero.
\end{handlist}
\end{frame}

\begin{frame}{Tool 4:   $n$-th derivative of a rational function}

Let $a \in \reals_{\neq 0} $ and $n$ a nonnegative integer. Then
\begin{equation*}
      \left.  D^n_x \left(\frac{1}{x-a}  \right) \right \vert_{x=0} = -\frac{n!}{a^{n+1}}.
\end{equation*}
And let $a,b \in \reals_{\neq 0} $ with $a \neq b$  and let $n$ a nonnegative integer. Then
\begin{equation*}
      \left.  D^n_x \left(\frac{1}{(x-a)(x-b)}  \right) \right \vert_{x=0} = -\frac{n!}{a-b} \left(\frac{1}{a^{n+1}} - \frac{1}{b^{n+1}} \right)
\end{equation*}
\end{frame}

\begin{frame}{Step 0}

Multiply the recursion $c_n = c_{n-1} + c_{n-2}+ 8$ by $z^n$ and sum from $n=2$ to $\infty$.  This gives
\begin{equation}
  \sum_{n=2}^\infty c_{n} z^n  =  \sum_{n=2}^\infty c_{n-1} z^n +  \sum_{n=2}^\infty c_{n-2} z^n +  \sum_{n=2}^\infty 8 z^n
\end{equation}
\begin{handlist}
\item The lowest sum index is two because the recursion  $c_n = c_{n-1} + c_{n-2}+ 8$ is only valid for $n \geq 2$.
\end{handlist}
\end{frame}
\begin{frame}{Step 1}

If needed, shift each sum index to make the each summand involve $c_n$, not $c_{n-1}$ or $c_{n-2}$.
\begin{equation}
  \sum_{n=2}^\infty c_{n} z^n  =  \sum_{n=1}^\infty c_{n} z^{n+1} +  \sum_{n=0}^\infty c_{n} z^{n+2} +  \sum_{n=2}^\infty 8 z^n
\end{equation}
\begin{handlist}
\item The lowest sum index is two because the recursion  $c_n = c_{n-1} + c_{n-2}+ 8$ is only valid for $n \geq 2$.
\end{handlist}
\end{frame}

\begin{frame}{Step 2}
Use the known values of $c_0$ and $c_1$ to extend the lower sum index of each sum to zero.
\begin{equation}
  \sum_{n=0}^\infty c_{n} z^n  =  z \sum_{n=0}^\infty c_{n} z^{n} +  z^2 \sum_{n=0}^\infty c_{n} z^{n} +  \sum_{n=2}^\infty 8 z^n
\end{equation}
\begin{handlist}
\item If $c_0$ and $c_1$ were nonzero, we'd have a few more terms!
\end{handlist}
\end{frame}

\begin{frame}{Step 3}

Define $G(z) =  \sum_{n=0}^\infty c_{n} z^n$ and $F(x) = \sum_{n=2}^\infty 8 z^n$. We have
\begin{equation}
  G(z) = z G(z) + z^2 G(z) + F(z)
\end{equation}
So 
\begin{equation}
  G(z) = \frac{1}{1-z-z^2} F(x).
\end{equation}



\end{frame}
\begin{frame}{Step 3}
From $G$, determine $c_n$. We have
\begin{align*}
 c_n &= \frac{1}{n!}  \left. D^n_z  \frac{1}{1-z-z^2} F(x) \right  \vert_{x=0}, \\
       &= \frac{1}{n!}  \left. \sum_{k=0}^n \binom{n}{k} D^k_z \left( \frac{1}{1-z-z^2} \right)  D^{n-k} _z F(z )  \right \vert_{z=0} 
\end{align*}

\end{frame}

\begin{frame}{Step 3}
Find the k-th derivative of $\left( \frac{1}{1-z-z^2} \right) $.   The factors of $1-z-z^2$ are a bit messy, so let's just give them names. Say
\begin{align*}
   D^k_z \left( \frac{1}{1-z-z^2} \right)  &=  D^k_z \left( -\frac{1}{(z-a)(z-b)} \right) , \\
                                                                       &=   \frac{n!}{a-b} \left(\frac{1}{a^{n+1}} - \frac{1}{b^{n+1}} \right)
\end{align*}
Actually,
\[
   a =  -\frac{\sqrt{5}+1}{2}, \quad b = \frac{\sqrt{5}-1}{2}
\]
That makes $a-b = -\sqrt{5}$. 
\end{frame}

\begin{frame}{Step 3}
Find the n-k th derivative of $F(z) $.

\begin{equation}
D^{n-k} _z F(z ) \vert_{z=0}  = (n-k) ! \begin{cases} 0 &  n -k < 2 \\  8  & n -k \geq  2 \end{cases}.
\end{equation}
\end{frame}
\begin{frame}{Step 3}
Collecting these results gives

\[
 c_n = -\frac{8}{\sqrt{5}} \sum_{k=0}^{n-2} \left ( \frac{1}{a^{k+1}} - \frac{1}{b^{k+1}} \right) 
\]
We find an explicit sum, but the result is a bit messy.  Let's settle for an approximation. The term $b^{-k}$ grows exponentially while $a^{-n}$ decays exponentially, so let's ignore all terms except the growing exponential. That gives
\[
 c_n \approx  \frac{8}{\sqrt{5}} \sum_{k=0}^{n-2} \frac{1}{b^{k+1}} \approx  \frac{8 b}{\sqrt{5}} \frac{{{b}^{-n}}}{1-b}
\]
\begin{equation}
   c_n \approx 5.8 \times 1.6^n
\end{equation}
\end{frame}

\begin{frame}
The value of 
\begin{align*}
c_{300} &= 2876634601652668487694125321377512792418937714474137858044718400, \\
             &\approx 5.626 \times 10^{209}.
\end{align*}
Our aproximation gives $c_{300} \approx 5.8 \times 1.6^{300}  =  5.633 \times 10^{209}.$

\end{frame}
\end{document}

